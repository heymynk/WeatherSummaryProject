<template>
    <lightning-button label="Send Customized Email" onclick={openModal}></lightning-button>
   
    <template if:true={isModalOpen}>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Send Email</h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                    <lightning-input
                        name="toAddress"
                        value={toAddress}
                        label="To"
                        placeholder="Email"
                        onchange={handleToEmailAddress}>
                    </lightning-input>
                    <lightning-input
                        name="orgWideAddress"
                        label="From"
                        placeholder="Email"
                        value={orgWideAddress}
                        disabled>
                    </lightning-input>
                    <lightning-combobox
                        label="Email Template Folder"
                        placeholder="Select Email Template Folders"
                        options={getTempList}
                        onchange={handleEmailTempFolderChange}
                        class="validate"
                        required>
                    </lightning-combobox>
                    <lightning-combobox
                        label="Email Template"
                        placeholder="Select Email Template"
                        options={emailTempList}
                        onchange={handleEmailTemplateChange}
                        class="validate"
                        required>
                    </lightning-combobox>
                    <lightning-input
                        label="Subject"
                        placeholder="Subject"
                        onchange={handleSubject}
                        value={subject}>
                    </lightning-input>
                    <br>
                    <lightning-input-rich-text
                        value={body}
                        onchange={handleBodyChange}>
                    </lightning-input-rich-text>
                    <br>
                    <lightning-file-upload
                        label="Attach Files"
                        name="uploadFile"
                        accept={acceptedFormats}
                        record-id={recordId}
                        onuploadfinished={handleUploadFinished}
                        multiple>
                    </lightning-file-upload>
                    <br>
                    <template if:true={uploadFile}>
                        <template for:each={uploadFile} for:item="fileIterator" for:index="index">
                            <lightning-pill
                                class="FilesPill"
                                key={fileIterator.contentVersionId}
                                label={fileIterator.name}
                                data-id={fileIterator.contentVersionId}
                                data-index={index}
                                onremove={fileRemove}>
                            </lightning-pill>
                        </template>
                    </template>
                </div>
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_neutral" onclick={cancelPopup}>Cancel</button>
                    <button class="slds-button slds-button_brand" onclick={sendEmail}>Send Email</button>
                </footer>
            </div>
        </section>
    </template>
</template>
